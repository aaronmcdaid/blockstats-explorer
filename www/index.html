<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockStats Explorer</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apache-arrow@14.0.2/Arrow.es2015.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Mobile overlay controls -->
        <div class="mobile-overlay">
            <div class="header-overlay" id="headerOverlayMobile">
                <h1>BlockStats Explorer</h1>
                <p>Interactive visualization of per-block Bitcoin statistics with client-side analytics</p>
                <div class="loading-status" id="loadingStatusMobile">Loading WASM module...</div>
                <div class="progress-container" id="progressContainerMobile" style="display: none;">
                    <div class="progress-bar" id="progressBarMobile"></div>
                </div>
            </div>

        </div>

        <!-- Desktop header (hidden on mobile) -->
        <header id="headerDesktop">
            <h1>BlockStats Explorer</h1>
            <p>Interactive visualization of per-block Bitcoin statistics with client-side analytics</p>
            <div class="loading-status" id="loadingStatusDesktop">Loading WASM module...</div>
            <div class="progress-container" id="progressContainerDesktop" style="display: none;">
                <div class="progress-bar" id="progressBarDesktop"></div>
            </div>
        </header>


        <div class="chart-container">
            <!-- Metric management buttons -->
            <button class="axis-button axis-button-left" id="leftAxisButton">+/-</button>
            <button class="axis-button axis-button-right" id="rightAxisButton">+/-</button>

            <div id="mainChart"></div>
        </div>

        <div class="data-info">
            <div id="dataRange" class="data-range-info">
                Loading...
            </div>
        </div>

        <footer>
            <p>
                Built with Rust + WebAssembly + Apache Arrow + Plotly.js<br>
                Data processing happens entirely in your browser
            </p>
        </footer>
    </div>

    <!-- Metric management modal -->
    <div class="metric-modal-overlay" id="metricModal" style="display: none;">
        <div class="metric-modal-content">
            <div class="metric-modal-header">
                <h3 id="modalTitle">Manage Left Axis</h3>
                <button class="modal-close" id="modalClose">√ó</button>
            </div>

            <!-- Current metrics section -->
            <div class="current-metrics-section">
                <h4>Current Metrics:</h4>
                <div class="current-metrics-list" id="currentMetricsList">
                    <!-- Current metrics will be populated here -->
                </div>
            </div>

            <!-- Add new metrics section -->
            <div class="add-metrics-section">
                <h4>Add New Metric:</h4>

                <div class="ma-selector">
                    <label for="maDropdown">Moving Average:</label>
                    <select id="maDropdown">
                        <option value="none" selected>None</option>
                        <option value="200">200 blocks</option>
                        <option value="1000">1000 blocks</option>
                        <option value="2016">2016 blocks</option>
                    </select>
                </div>

                <div class="available-metrics-list" id="availableMetricsList">
                    <!-- Available metrics will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Simple tutorial overlay - shows after data loading -->
    <div class="tutorial-overlay" id="tutorialOverlay" style="display: none;">
        <div class="tutorial-content">
            <h2>üìä How to Explore Bitcoin Data</h2>

            <div class="tutorial-section">
                <div class="tutorial-item">
                    <div class="tutorial-icon">üîç</div>
                    <div class="tutorial-text">
                        <h3>Zoom In</h3>
                        <p>Draw a box around any area to zoom in</p>
                    </div>
                </div>

                <div class="tutorial-item">
                    <div class="tutorial-icon">üëÜ</div>
                    <div class="tutorial-text">
                        <h3>Pan Around</h3>
                        <p>Drag on the chart axes to move around</p>
                    </div>
                </div>

                <div class="tutorial-item">
                    <div class="tutorial-icon">‚Ü©Ô∏è</div>
                    <div class="tutorial-text">
                        <h3>Reset View</h3>
                        <p>Double-click anywhere to zoom out fully</p>
                    </div>
                </div>
            </div>

            <div class="tutorial-footer">
                <p class="dismiss-hint">üí° Click anywhere to dismiss</p>
                <button class="tutorial-dismiss" id="tutorialDismiss">Got it! üöÄ</button>
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>